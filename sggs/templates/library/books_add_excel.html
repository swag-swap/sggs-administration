{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container mt-5 table-responsive">
    <h1>Add Books from Excel</h1>
    
    <!-- Form for Uploading Excel File -->
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <label for="excel_file">Select Excel File:</label>
            <input type="file" name="excel_file" id="excel_file" class="form-control-file">
        </div>
        <button type="submit" class="btn btn-primary">Upload</button>
        <a href="{% static 'samples/Add_books.xlsx' %}" download class="btn btn-secondary">Download Sample File</a>
    </form>

    <!-- Display any errors -->
    {% if errors %}
        <h2 class="mt-5">Errors:</h2>
        <ul>
            {% for error in errors %}
                <a  class="btn btn-warning btn-icon-split">
                    <span class="icon text-white">
                        <i class="fas fa-exclamation-triangle"></i>
                    </span>
                    <span class="text">{{ error }}</span>
                </a> 
            {% endfor %}
        </ul>
    {% endif %}
    
    <!-- Display Added Books -->
    {% if added_books %}
    <h2>Added Books:</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Department</th>
                <th>edition</th>
                <th>publication_date</th>
                <th>isbn</th>
                <th>Available Copies</th>
                <th>Total Copies</th> 
                <th>Fine Rate</th>
            </tr>
        </thead>
        <tbody>
            {% for book in added_books %}
            <tr>
                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td>{{ book.department.name }}</td>
                <td>{{ book.edition }}</td>
                <td>{{ book.publication_date }}</td>
                <td>{{ book.isbn }}</td>
                <td>{{ book.available_copies }}</td>
                <td>{{ book.total_copies }}</td>
                <td>{{ book.fine_rate }}</td> 
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    <!-- Display Updated Books -->
    {% if updated_books %}
    <h2>Updated Books:</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Department</th>
                <th>edition</th>
                <th>publication_date</th>
                <th>isbn</th>
                <th>Available Copies</th>
                <th>Total Copies</th> 
                <th>Fine Rate</th>
            </tr>
        </thead>
        <tbody>
            {% for book in updated_books %}
            <tr>
                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td>{{ book.department.name }}</td>
                <td>{{ book.edition }}</td>
                <td>{{ book.publication_date }}</td>
                <td>{{ book.isbn }}</td>
                <td>{{ book.available_copies }}</td>
                <td>{{ book.total_copies }}</td>
                <td>{{ book.fine_rate }}</td> 
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>

{% endblock %}
